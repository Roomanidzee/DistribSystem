{% extends 'accounts/my_profile.html' %}
{% block content %}
<table border="1">
  <caption>Таблица реквестов</caption>
  
  <tr>
    <th>Кто подал реквест</th>
    <th>Название контейнера</th>
    <th>Статус</th>
    <th>Действие</th>
  </tr>
  <tr>
  {% for list in requests %}
        {% for req in list %}
        <td> {{ req.student }} </td>
        <td> {{ req.container }} </td>
        <td> {% if req.status == 0 %}
                    Рассматривается
                {% elif req.status == 1 %}
                    Принята
                {% elif req.status == 2 %}
                    Отклонена
                {% endif %} </td>
        <td>
            <form action="{% url 'choose_distrib:professor_request_change_status'  user_id   req.request_type   req.container.id   req.student.id   1 %}" method="post">
            {% csrf_token %}
            <input type="submit" name="accept" value="Принять">
            </form>
            <form action="{% url 'choose_distrib:professor_request_change_status'  user_id   req.request_type   req.container.id   req.student.id   2 %}" method="post">
            {% csrf_token %}
            <input type="submit" name="decline" value="Отклонить">
            </form>
        </td>
    </tr>
    {% endfor %}
  {% endfor %}
</table>

<div class="panel panel-default">
  <!-- Default panel contents -->
  <div class="panel-heading">Таблица</div>
  <table class="table table-hover">
    <thead>
        <tr>
          <th></th>
          <th id="name" class="col-lg-4">ФИО Студента</th>
          <th id="description" class="col-lg-4">Лаборатория</th>
          <th id="application" class="col-lg-4">Статус</th>
        </tr>
    </thead>
    <tbody>
        {% for req in requests %}
          <script type="text/javascript">
            //Если состояние реквеста 0, то покажи кнопки
            //Если не 0 а 1, то покажи Принято
            //Если не 0 а 2, то покаэи Отклонено
            //Если что-то другое, то покаэи Неверный статус реквеста: (статус)
              $(document).ready(function () {
                document.getElementById('success{{ req.id }}').onclick = function(){


                  document.getElementById('btn1').innerHTML = {% if req.status == 0 %}
                                                                'Рассматривается'
                                                              {% elif req.status == 1 %}
                                                                'Принят'
                                                              {% elif req.status == 2 %}
                                                                'Отклонен'
                                                              {% else %}
                                                                'Неверный статус реквеста: {{ req.status }}'
                                                              {% endif %};
                }
                document.getElementById('cancel1{{ req.id }}').onclick = function(){
                  document.getElementById('btn1').innerHTML = 'Отклонен';
                }
              });
          </script>
          <tr>
            <th scope="row">1</th>
            <td align="center"><span id="space">{{ req.student.name }} {{ req.student.surname }}<br>{{ req.student.email }}</span></td>
            <td align="center">{{ req.container }}</td>
            <td align="center">
              <div id="btn1">
                <form action="{% url 'choose_distrib:professor_request_change_status'  user_id   req.request_type   req.container.id   req.student.id   1 %}" method="post">
                  {% csrf_token %}  
                  <div id="btn_cont{{ req.id }}">
                    <button type="submit" id="success{{ req.id }}" value="Принять" name="accept" name="decline" class="btn">Принять</button>
                  </div>
                </form>
                <form action="{% url 'choose_distrib:professor_request_change_status'  user_id   req.request_type   req.container.id   req.student.id   2 %}" method="post">
                  {% csrf_token %}
                  <div id="">
                    <button type="submit" id="cancel{{ req.id }}" value="Отклонить" name="decline" class="btn">Отклонить</button>
                  </div>
                </form>
              </div>
            </td>
          </tr>
        {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}